==> Starting Consul agent...
==> Consul agent running!
           Version: 'v0.9.3'
           Node ID: 'eca9f263-1767-757d-281a-7dcf923a316e'
         Node name: 'web2-node'
        Datacenter: 'dc1' (Segment: '<all>')
            Server: true (Bootstrap: false)
       Client Addr: 0.0.0.0 (HTTP: 8500, HTTPS: -1, DNS: 8600)
      Cluster Addr: 172.28.128.6 (LAN: 8301, WAN: 8302)
           Encrypt: Gossip: false, TLS-Outgoing: false, TLS-Incoming: false

==> Log data will now stream in as it occurs:

    2017/10/16 16:58:22 [INFO] raft: Initial configuration (index=1169): [{Suffrage:Voter ID:172.28.128.6:8300 Address:172.28.128.6:8300} {Suffrage:Voter ID:172.28.128.5:8300 Address:172.28.128.5:8300} {Suffrage:Voter ID:172.28.128.3:8300 Address:172.28.128.3:8300} {Suffrage:Voter ID:172.28.128.4:8300 Address:172.28.128.4:8300}]
    2017/10/16 16:58:22 [INFO] raft: Node at 172.28.128.6:8300 [Follower] entering Follower state (Leader: "")
    2017/10/16 16:58:22 [INFO] serf: EventMemberJoin: web2-node.dc1 172.28.128.6
    2017/10/16 16:58:22 [INFO] serf: EventMemberJoin: web2-node 172.28.128.6
    2017/10/16 16:58:22 [INFO] consul: Adding LAN server web2-node (Addr: tcp/172.28.128.6:8300) (DC: dc1)
    2017/10/16 16:58:22 [INFO] consul: Handled member-join event for server "web2-node.dc1" in area "wan"
    2017/10/16 16:58:22 [INFO] agent: Started DNS server 0.0.0.0:8600 (tcp)
    2017/10/16 16:58:22 [INFO] agent: Started DNS server 0.0.0.0:8600 (udp)
    2017/10/16 16:58:22 [INFO] agent: Started HTTP server on [::]:8500
    2017/10/16 16:58:22 [INFO] agent: Retry join LAN is supported for: aws azure gce softlayer
    2017/10/16 16:58:22 [INFO] agent: Joining LAN cluster...
    2017/10/16 16:58:22 [INFO] agent: (LAN) joining: [172.28.128.5 172.28.128.3]
2017/10/16 16:58:23 [DEBUG] raft-net: 172.28.128.6:8300 accepted connection from: 172.28.128.3:46682
==> Newer Consul version available: 1.0.0 (currently running: 0.9.3)
    2017/10/16 16:58:25 [INFO] serf: EventMemberJoin: web1-node 172.28.128.3
    2017/10/16 16:58:25 [INFO] agent: (LAN) joined: 1 Err: <nil>
    2017/10/16 16:58:25 [INFO] agent: Join LAN completed. Synced with 1 initial agents
    2017/10/16 16:58:25 [INFO] consul: Adding LAN server web1-node (Addr: tcp/172.28.128.3:8300) (DC: dc1)
    2017/10/16 16:58:25 [INFO] serf: EventMemberJoin: web1-node.dc1 172.28.128.3
    2017/10/16 16:58:25 [INFO] consul: Handled member-join event for server "web1-node.dc1" in area "wan"
    2017/10/16 16:58:30 [ERR] agent: failed to sync remote state: No cluster leader
    2017/10/16 16:58:47 [ERR] agent: Coordinate update error: No cluster leader
    2017/10/16 16:58:47 [WARN] raft: Heartbeat timeout from "" reached, starting election
    2017/10/16 16:58:47 [INFO] raft: Node at 172.28.128.6:8300 [Candidate] entering Candidate state in term 100
    2017/10/16 16:58:49 [ERR] raft: Failed to make RequestVote RPC to {Voter 172.28.128.5:8300 172.28.128.5:8300}: dial tcp 172.28.128.6:0->172.28.128.5:8300: getsockopt: connection refused
    2017/10/16 16:58:50 [ERR] raft: Failed to make RequestVote RPC to {Voter 172.28.128.4:8300 172.28.128.4:8300}: dial tcp 172.28.128.6:0->172.28.128.4:8300: getsockopt: no route to host
    2017/10/16 16:58:53 [ERR] agent: failed to sync remote state: No cluster leader
    2017/10/16 16:58:54 [INFO] raft: Node at 172.28.128.6:8300 [Follower] entering Follower state (Leader: "")
    2017/10/16 16:58:59 [WARN] raft: Heartbeat timeout from "" reached, starting election
    2017/10/16 16:58:59 [INFO] raft: Node at 172.28.128.6:8300 [Candidate] entering Candidate state in term 102
    2017/10/16 16:58:59 [ERR] raft: Failed to make RequestVote RPC to {Voter 172.28.128.5:8300 172.28.128.5:8300}: dial tcp 172.28.128.6:0->172.28.128.5:8300: getsockopt: connection refused
    2017/10/16 16:59:02 [ERR] raft: Failed to make RequestVote RPC to {Voter 172.28.128.4:8300 172.28.128.4:8300}: dial tcp 172.28.128.6:0->172.28.128.4:8300: getsockopt: no route to host
    2017/10/16 16:59:07 [INFO] raft: Node at 172.28.128.6:8300 [Follower] entering Follower state (Leader: "")
    2017/10/16 16:59:11 [INFO] serf: EventMemberJoin: db2-node 172.28.128.5
    2017/10/16 16:59:11 [INFO] consul: Adding LAN server db2-node (Addr: tcp/172.28.128.5:8300) (DC: dc1)
    2017/10/16 16:59:12 [INFO] serf: EventMemberJoin: db2-node.dc1 172.28.128.5
    2017/10/16 16:59:12 [INFO] consul: Handled member-join event for server "db2-node.dc1" in area "wan"
    2017/10/16 16:59:12 [ERR] agent: Coordinate update error: No cluster leader
    2017/10/16 16:59:15 [WARN] raft: Heartbeat timeout from "" reached, starting election
    2017/10/16 16:59:15 [INFO] raft: Node at 172.28.128.6:8300 [Candidate] entering Candidate state in term 104
    2017/10/16 16:59:15 [INFO] raft: Election won. Tally: 3
    2017/10/16 16:59:15 [INFO] raft: Node at 172.28.128.6:8300 [Leader] entering Leader state
    2017/10/16 16:59:15 [INFO] raft: Added peer 172.28.128.5:8300, starting replication
    2017/10/16 16:59:15 [INFO] raft: Added peer 172.28.128.3:8300, starting replication
    2017/10/16 16:59:15 [INFO] raft: Added peer 172.28.128.4:8300, starting replication
    2017/10/16 16:59:15 [INFO] consul: cluster leadership acquired
    2017/10/16 16:59:15 [INFO] consul: New leader elected: web2-node
    2017/10/16 16:59:15 [INFO] raft: pipelining replication to peer {Voter 172.28.128.5:8300 172.28.128.5:8300}
    2017/10/16 16:59:15 [INFO] raft: pipelining replication to peer {Voter 172.28.128.3:8300 172.28.128.3:8300}
    2017/10/16 16:59:15 [INFO] consul: member 'db1-node' reaped, deregistering
    2017/10/16 16:59:15 [INFO] agent: Synced node info
    2017/10/16 16:59:17 [WARN] raft: Failed to contact 172.28.128.4:8300 in 2.504851045s
    2017/10/16 16:59:18 [ERR] raft: Failed to heartbeat to 172.28.128.4:8300: dial tcp 172.28.128.6:0->172.28.128.4:8300: getsockopt: no route to host
    2017/10/16 16:59:18 [ERR] raft: Failed to AppendEntries to {Voter 172.28.128.4:8300 172.28.128.4:8300}: dial tcp 172.28.128.6:0->172.28.128.4:8300: getsockopt: no route to host
    2017/10/16 16:59:18 [ERR] raft: Failed to make RequestVote RPC to {Voter 172.28.128.4:8300 172.28.128.4:8300}: dial tcp 172.28.128.6:0->172.28.128.4:8300: getsockopt: no route to host
    2017/10/16 16:59:20 [WARN] raft: Failed to contact 172.28.128.4:8300 in 4.96418296s
    2017/10/16 16:59:21 [ERR] raft: Failed to heartbeat to 172.28.128.4:8300: dial tcp 172.28.128.6:0->172.28.128.4:8300: getsockopt: no route to host
    2017/10/16 16:59:21 [ERR] raft: Failed to AppendEntries to {Voter 172.28.128.4:8300 172.28.128.4:8300}: dial tcp 172.28.128.6:0->172.28.128.4:8300: getsockopt: no route to host
    2017/10/16 16:59:22 [WARN] raft: Failed to contact 172.28.128.4:8300 in 7.452749066s
    2017/10/16 16:59:24 [ERR] raft: Failed to heartbeat to 172.28.128.4:8300: dial tcp 172.28.128.6:0->172.28.128.4:8300: getsockopt: no route to host
    2017/10/16 16:59:24 [ERR] raft: Failed to AppendEntries to {Voter 172.28.128.4:8300 172.28.128.4:8300}: dial tcp 172.28.128.6:0->172.28.128.4:8300: getsockopt: no route to host
    2017/10/16 16:59:25 [INFO] autopilot: Attempting removal of stale raft server : 172.28.128.4:8300
    2017/10/16 16:59:25 [INFO] raft: Updating configuration with RemoveServer (172.28.128.4:8300, ) to [{Suffrage:Voter ID:172.28.128.6:8300 Address:172.28.128.6:8300} {Suffrage:Voter ID:172.28.128.5:8300 Address:172.28.128.5:8300} {Suffrage:Voter ID:172.28.128.3:8300 Address:172.28.128.3:8300}]
    2017/10/16 16:59:25 [INFO] raft: Removed peer 172.28.128.4:8300, stopping replication after 2296
    2017/10/16 16:59:27 [ERR] raft: Failed to heartbeat to 172.28.128.4:8300: dial tcp 172.28.128.6:0->172.28.128.4:8300: getsockopt: no route to host
    2017/10/16 16:59:27 [ERR] raft: Failed to AppendEntries to {Voter 172.28.128.4:8300 172.28.128.4:8300}: dial tcp 172.28.128.6:0->172.28.128.4:8300: getsockopt: no route to host
    2017/10/16 16:59:30 [ERR] raft: Failed to heartbeat to 172.28.128.4:8300: dial tcp 172.28.128.6:0->172.28.128.4:8300: getsockopt: no route to host
    2017/10/16 16:59:30 [ERR] raft: Failed to AppendEntries to {Voter 172.28.128.4:8300 172.28.128.4:8300}: dial tcp 172.28.128.6:0->172.28.128.4:8300: getsockopt: no route to host
    2017/10/16 17:00:00 [INFO] serf: EventMemberJoin: db1-node 172.28.128.4
    2017/10/16 17:00:00 [INFO] consul: Adding LAN server db1-node (Addr: tcp/172.28.128.4:8300) (DC: dc1)
    2017/10/16 17:00:00 [INFO] raft: Updating configuration with AddStaging (172.28.128.4:8300, 172.28.128.4:8300) to [{Suffrage:Voter ID:172.28.128.6:8300 Address:172.28.128.6:8300} {Suffrage:Voter ID:172.28.128.5:8300 Address:172.28.128.5:8300} {Suffrage:Voter ID:172.28.128.3:8300 Address:172.28.128.3:8300} {Suffrage:Voter ID:172.28.128.4:8300 Address:172.28.128.4:8300}]
    2017/10/16 17:00:00 [INFO] raft: Added peer 172.28.128.4:8300, starting replication
    2017/10/16 17:00:00 [INFO] serf: EventMemberJoin: db1-node.dc1 172.28.128.4
    2017/10/16 17:00:00 [INFO] consul: Handled member-join event for server "db1-node.dc1" in area "wan"
    2017/10/16 17:00:00 [INFO] consul: member 'db1-node' joined, marking health alive
    2017/10/16 17:00:00 [WARN] raft: AppendEntries to {Voter 172.28.128.4:8300 172.28.128.4:8300} rejected, sending older logs (next: 2289)
    2017/10/16 17:00:01 [INFO] raft: pipelining replication to peer {Voter 172.28.128.4:8300 172.28.128.4:8300}
    2017/10/16 17:56:48 [INFO] serf: EventMemberLeave: db1-node.dc1 172.28.128.4
    2017/10/16 17:56:48 [INFO] consul: Handled member-leave event for server "db1-node.dc1" in area "wan"
    2017/10/16 17:56:49 [INFO] serf: EventMemberLeave: db1-node 172.28.128.4
    2017/10/16 17:56:49 [INFO] consul: Removing LAN server db1-node (Addr: tcp/172.28.128.4:8300) (DC: dc1)
    2017/10/16 17:56:49 [INFO] consul: removing server by address: "172.28.128.4:8300"
    2017/10/16 17:56:49 [INFO] raft: Updating configuration with RemoveServer (172.28.128.4:8300, ) to [{Suffrage:Voter ID:172.28.128.6:8300 Address:172.28.128.6:8300} {Suffrage:Voter ID:172.28.128.5:8300 Address:172.28.128.5:8300} {Suffrage:Voter ID:172.28.128.3:8300 Address:172.28.128.3:8300}]
    2017/10/16 17:56:49 [INFO] raft: Removed peer 172.28.128.4:8300, stopping replication after 2786
    2017/10/16 17:56:49 [INFO] raft: aborting pipeline replication to peer {Voter 172.28.128.4:8300 172.28.128.4:8300}
    2017/10/16 17:56:49 [INFO] consul: member 'db1-node' left, deregistering
    2017/10/16 17:56:55 [INFO] raft: aborting pipeline replication to peer {Voter 172.28.128.5:8300 172.28.128.5:8300}
    2017/10/16 17:56:55 [ERR] raft: Failed to AppendEntries to {Voter 172.28.128.5:8300 172.28.128.5:8300}: EOF
    2017/10/16 17:56:55 [ERR] raft: Failed to AppendEntries to {Voter 172.28.128.5:8300 172.28.128.5:8300}: dial tcp 172.28.128.6:0->172.28.128.5:8300: getsockopt: connection refused
    2017/10/16 17:56:55 [ERR] raft: Failed to AppendEntries to {Voter 172.28.128.5:8300 172.28.128.5:8300}: dial tcp 172.28.128.6:0->172.28.128.5:8300: getsockopt: connection refused
    2017/10/16 17:56:55 [ERR] raft: Failed to AppendEntries to {Voter 172.28.128.5:8300 172.28.128.5:8300}: dial tcp 172.28.128.6:0->172.28.128.5:8300: getsockopt: connection refused
    2017/10/16 17:56:56 [ERR] raft: Failed to AppendEntries to {Voter 172.28.128.5:8300 172.28.128.5:8300}: dial tcp 172.28.128.6:0->172.28.128.5:8300: getsockopt: connection refused
    2017/10/16 17:56:56 [ERR] raft: Failed to AppendEntries to {Voter 172.28.128.5:8300 172.28.128.5:8300}: dial tcp 172.28.128.6:0->172.28.128.5:8300: getsockopt: connection refused
    2017/10/16 17:56:56 [ERR] raft: Failed to heartbeat to 172.28.128.5:8300: dial tcp 172.28.128.6:0->172.28.128.5:8300: getsockopt: connection refused
    2017/10/16 17:56:56 [ERR] raft: Failed to AppendEntries to {Voter 172.28.128.5:8300 172.28.128.5:8300}: dial tcp 172.28.128.6:0->172.28.128.5:8300: getsockopt: connection refused
    2017/10/16 17:56:58 [WARN] raft: Failed to contact 172.28.128.5:8300 in 2.500571796s
    2017/10/16 17:57:00 [WARN] raft: Failed to contact 172.28.128.5:8300 in 4.948195003s
    2017/10/16 17:57:02 [INFO] Caught signal:  terminated
    2017/10/16 17:57:02 [INFO] Gracefully shutting down agent...
    2017/10/16 17:57:02 [INFO] consul: server starting leave
    2017/10/16 17:57:02 [INFO] raft: Updating configuration with RemoveServer (172.28.128.6:8300, ) to [{Suffrage:Voter ID:172.28.128.5:8300 Address:172.28.128.5:8300} {Suffrage:Voter ID:172.28.128.3:8300 Address:172.28.128.3:8300}]
    2017/10/16 17:57:02 [INFO] Caught second signal terminated. Exiting
    2017/10/16 17:57:02 [INFO] agent: Requesting shutdown
    2017/10/16 17:57:02 [INFO] consul: shutting down server
    2017/10/16 17:57:02 [WARN] serf: Shutdown without a Leave
    2017/10/16 17:57:02 [WARN] serf: Shutdown without a Leave
    2017/10/16 17:57:02 [INFO] manager: shutting down
    2017/10/16 17:57:02 [ERR] consul: failed to remove ourself as raft peer: leadership lost while committing log
    2017/10/16 17:57:02 [ERR] consul: failed to leave WAN Serf cluster: Leave called after Shutdown
    2017/10/16 17:57:02 [ERR] consul: failed to leave LAN Serf cluster: Leave called after Shutdown
    2017/10/16 17:57:02 [INFO] raft: aborting pipeline replication to peer {Voter 172.28.128.3:8300 172.28.128.3:8300}
    2017/10/16 17:57:06 [ERR] raft: Failed to AppendEntries to {Voter 172.28.128.5:8300 172.28.128.5:8300}: dial tcp 172.28.128.6:0->172.28.128.5:8300: i/o timeout
    2017/10/16 17:57:07 [ERR] raft: Failed to heartbeat to 172.28.128.5:8300: dial tcp 172.28.128.6:0->172.28.128.5:8300: i/o timeout
    2017/10/16 17:57:07 [INFO] memberlist: Suspect db2-node has failed, no acks received
    2017/10/16 17:57:07 [ERR] memberlist: Failed to send ping: write udp 172.28.128.6:8301->172.28.128.3:8301: use of closed network connection
    2017/10/16 17:57:15 [ERR] agent: Coordinate update error: No cluster leader
    2017/10/16 17:57:16 [ERR] raft: Failed to AppendEntries to {Voter 172.28.128.5:8300 172.28.128.5:8300}: dial tcp 172.28.128.6:0->172.28.128.5:8300: i/o timeout
    2017/10/16 17:57:18 [ERR] raft: Failed to heartbeat to 172.28.128.5:8300: dial tcp 172.28.128.6:0->172.28.128.5:8300: i/o timeout
    2017/10/16 17:57:18 [INFO] agent: consul server down
    2017/10/16 17:57:18 [INFO] agent: shutdown complete
    2017/10/16 17:57:18 [INFO] agent: Stopping DNS server 0.0.0.0:8600 (tcp)
    2017/10/16 17:57:18 [INFO] agent: Stopping DNS server 0.0.0.0:8600 (udp)
    2017/10/16 17:57:18 [INFO] agent: Stopping HTTP server [::]:8500
    2017/10/16 17:57:18 [INFO] agent: Waiting for endpoints to shut down
    2017/10/16 17:57:18 [INFO] agent: Endpoints down
    2017/10/16 17:57:18 [INFO] Exit code:  1
